spring.application.name=ussd-gateway

# ===== R2DBC (WEBFLUX) =====
# spring.r2dbc.url=r2dbc:postgresql://aws-1-eu-central-1.pooler.supabase.com:5432/postgres?sslMode=require
# spring.r2dbc.username=postgres.rheooaaomujhljjejohz
# spring.r2dbc.password=BuZXAA1Rs6qO3VlA

spring.r2dbc.url=r2dbc:postgresql://localhost:5432/ussd_db
spring.r2dbc.username=n
spring.r2dbc.password=nkwarukunai124

# Server Configuration
server.port=8080
server.servlet.encoding.charset=UTF-8

# Logging
logging.level.com.ussdgateway=DEBUG
logging.level.org.springframework.r2dbc=DEBUG

# Désactiver JPA
spring.jpa.enabled=false
spring.jpa.hibernate.ddl-auto=none

# Logging
logging.level.org.springframework.data.r2dbc=DEBUG
logging.level.liquibase=DEBUG
logging.level.liquibase.executor=DEBUG
logging.level.org.springframework.boot.autoconfigure.liquibase=DEBUG

# Configuration Liquibase
spring.liquibase.enabled=true
spring.liquibase.change-log=classpath:db/changelog/db-changelog-master.xml
spring.liquibase.url=jdbc:postgresql://localhost:5432/ussd_db
spring.liquibase.user=n
spring.liquibase.password=nkwarukunai124
spring.liquibase.driver-class-name=org.postgresql.Driver


# Application Configuration
app.name=USSD Integration System
app.version=1.0.0
app.session.timeout=600000
app.session.idle-timeout=300000

spring.messages.basename=messages
spring.messages.encoding=UTF-8

# ===== Static Resources Configuration =====
spring.web.resources.add-mappings=true
spring.web.resources.static-locations=classpath:/static/

# ===== JPA Configuration (Disabled) =====
spring.jpa.enabled=false
spring.jpa.hibernate.ddl-auto=none

# ===== Server Configuration =====
server.port=8080
server.servlet.encoding.charset=UTF-8

# ===== USSD Configuration =====
# Code USSD du menu principal (par défaut: *500#)
ussd.main-menu.code=*500#

# Préfixe pour les codes de service (*500*1#, *500*2#, etc.)
ussd.service.code-prefix=*500*
ussd.service.code-suffix=#

# ===== Session Configuration =====
# Durée d'inactivité avant expiration (en minutes)
ussd.session.timeout-minutes=5

# Fréquence de nettoyage des sessions (en ms)
ussd.session.cleanup-rate-ms=60000

# Suppression définitive des anciennes sessions
ussd.session.hard-delete-after-days=7
ussd.session.hard-delete-cron=0 0 2 * * *


# ============================================================================
# CONFIGURATION BASE DE DONNÉES (R2DBC PostgreSQL)
# ============================================================================


# Pool de connexions
# File Upload Limits
spring.servlet.multipart.max-file-size=50MB
spring.servlet.multipart.max-request-size=50MB

# Server Limits (Netty/Tomcat)
server.max-http-header-size=100KB
spring.codec.max-in-memory-size=50MB
spring.r2dbc.pool.initial-size=10
spring.r2dbc.pool.max-size=50
spring.r2dbc.pool.max-idle-time=30m


logging.level.io.r2dbc.postgresql.QUERY=DEBUG
logging.level.liquibase=DEBUG
logging.level.liquibase.executor=DEBUG
logging.level.org.springframework.boot.autoconfigure.liquibase=DEBUG

# ===== Jackson Configuration =====
spring.jackson.serialization.write-dates-as-timestamps=false
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.r2dbc.properties.json=postgresql


# ============================================================================
# AI GENERATOR CONFIGURATION
# ============================================================================

# Provider Selection: huggingface | ollama
ai.generator.enabled=true
ai.generator.provider=huggingface

# Groq API Configuration (Via HuggingFace Client Adapter)
ai.generator.huggingface.api-key=Z3NrX0pZcDlzSWJtMXlqUXhNcUdkeEpMV0dyeWIzRll4NzJSdFYyWW1uQ3dpSVdxVUI1eEdjcTA=
ai.generator.huggingface.base-url=https://api.groq.com/openai/v1
ai.generator.huggingface.model=llama3-70b-8192
ai.generator.huggingface.timeout=60000
ai.generator.huggingface.max-tokens=8192

# Ollama Configuration (fallback local)
ai.generator.ollama.base-url=http://localhost:11434
ai.generator.ollama.model=llama3.2
ai.generator.ollama.timeout=600000
ai.generator.ollama.max-tokens=50000

# Fallback Configuration
ai.generator.fallback.use-heuristic=true
ai.generator.fallback.max-retries=3

# Validation Rules
ai.generator.validation.max-message-length=182
ai.generator.validation.max-menu-options=8
ai.generator.validation.min-states=3

# Swagger Parser
ai.generator.swagger.timeout=30000
ai.generator.swagger.max-file-size-mb=5

# Cache
ai.generator.cache.enabled=true
ai.generator.cache.ttl-minutes=60